## Введение
Данное приложение было разработано для распределенной передачи данных от сервера клиентам в рамках тестирования функционала передачи и приема данных.
Оно представляет собой сервис, который позволяет:
- создавать точки подключения (streampoints) для каждого сервера, одна точка - один сервер.
- создавать пользователей, при этом можно явным образом указать, к каким точкам имеет доступ данный пользователь, по умолчанию - ко всем точкам. Количество клиентов не ограничено.  

Для добавления, изменения, удаления и отслеживания точек подключения, пользователей реализован небольшой backend на FastApi.

Общая схема работы сервиса:
- при каждом новом подключении происходит определение, сервер это или клиент.
  Так как изначально сервис разрабатывался для работы с NTRIP протоколом, то сервер при соединении должен отправить строку типа
  'SOURCE server_password /streampoint\r\n'.
  Клиент определяется по строке 'GET /streampoint HTTP/1.1\r\nAuthorization: Basic dTI6cDI=\r\n'
- Сервер кладет данные в очередь (asyncio.Queue) с пометкой принадлежности к определенной точке подключения.
- Отдельная задача забирает эти данные из очереди и распределяет по всем активным клиентам для данной точки подключения.
- Конфигурация сервиса (точки подключения, пользователи) хранится в файле app_settings.json, который модифицируется по мере внесения изменений на backend и всегда отражает последнюю актуальную конфигурацию.
  В репозитории этот файл содержит некие настройки по умолчанию.

## Использование
1. Сохранить проект
##
    git clone https://github.com/ichobotov/example_scripts.git
2. Перейти в папку с проектом StreamCaster_app
##
    cd example_scripts/StreamCaster_app/
3. Запустить docker-compose (при необходимости через sudo)
##
    docker-compose up -d --build    

4. Backend доступен по ссылке http://localhost:8002/docs (либо вместо localhost использовать 0.0.0.0 или локальный адрес).
   Пароль server_password

5. Для примера запустить скрипт, имитирующий отправку сообщений сервером и их прием 5-ю клиентами для [user]:[password].  
   Параметры запуска [streampoint] [user] [password]

##
    python3 simple_example.py point1 user1 password1
6. Текущий статус точек подключения можно посмотреть на http://localhost:8002/docs или через GET запрос
##
     curl -X 'GET' 'http://0.0.0.0:8002/streampoints/' | python3 -m json.tool




